<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/css/edit_profile_css.css">
    <link rel="stylesheet" href="../static/css/no.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <title>팀 오리둥둥이1</title>
</head>

<body>
    <div class="edit_profile_container">
        <form class="bot_content" method="post">
            <img style="width:170px; height: 170px; border: 1px solid #ddd;" id="preview_image"
                src="https://dummyimage.com/500x500/ffffff/000000.png&text=preview+image">
            <input style="display: block;" type="file" id="input_image" accept=".jpg, .png" required>
            <h4>@유저이름</h4>
            <ul>
                <li>
                    <label for="username">닉네임</label>
                    <input id="username" type="text" minlength="4" maxlength="9" placeholder="닉네임" required>
                </li>
                <li>
                    <label for="email">이메일</label>
                    <input id="email" type="email" placeholder="이메일" minlength="1" maxlength="35" required>
                </li>
                <li>
                    <label for="phone_number">전화번호</label>
                    <input id="phone_number" type="number" maxlength="9" placeholder="전화번호" required>
                </li>
                <li>
                    <label for="gender">성별</label>
                    <select id="gender" required>
                        <option value="">-- 성별을 선택해주세요 --</option>
                        <option value="female">여성</option>
                        <option value="male">남성</option>
                    </select>
                </li>
                <li>
                    <label for="bio">자기소개</label>
                    <textarea id="bio" name="bio" rows="4" cols="43"></textarea>
                </li>
            </ul>

            <div class="submit_form">
                <a href="#">회원탈퇴</a>
                <div>
                    <a href="#">취소</a>
                    <input onclick="save_update_profile()" type="submit" value="변경">
                </div>
            </div>
        </form>

    </div>

</body>

</html>

<script>
    //사진 미리보기
    function readImage(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader()
            reader.onload = e => {
                const previewImage = document.getElementById("preview_image")
                previewImage.src = e.target.result
            }
            reader.readAsDataURL(input.files[0])
        }
    }
    const inputImage = document.getElementById("input_image")
    inputImage.addEventListener("change", e => {
        readImage(e.target)
    })
    // ajax
    function save_update_profile() {
        let username = $("#username").val()
        let email = $("#email").val()
        let phone_number = $("#phone_number").val()
        let gender = $("#gender").val();
        let avatar = $("#input_image").val();
        let bio = $("#bio").val();

        $.ajax({
            type: "POST",
            url: "/edit_profile",
            data: {
                username_receive: username,
                email_receive: email,
                phone_number_receive: phone_number,
                gender_receive: gender,
                avatar_receive: avatar,
                bio_receive: bio,
            },
            success: function (response) {
                alert(response["msg"])
                window.location.reload()
            }
        });
    }
</script>